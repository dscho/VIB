






------------------------------------------------------------------------

path file has to have:

x spacing
y spacing
z spacing
units

origin?

<tracings>

  <samplespacing x="0.5" y="0.5" z="1.78" units="um"/>

  <path id="0" d="M 100 200 60 L 100 200 61 L 100 201 62" startson="1" endson=""/>
  <path id="1" d="M 100 200 65 L 100 201 66" startson="3" startsindex="" endson="" endsindex=""/>
  <path id="3" d="M 100 200 60 L 100 200 61 L 100 201 62" endson=""/>

  <fill id="" frompathid="">
    <node id="" x="" y="" z="" previousid="" distance=""/>
    <node id="" x="" y="" z="" previousid="" distance=""/>
    <node id="" x="" y="" z="" previousid="" />
    <node id="" x="" y="" z="" previousid=""/>
    <node id="" x="" y="" z="" previousid=""/>
  </fill>

</tracings>




------------------------------------------------------------------------


change terminology:
  - 

add Escape to cancel current action (e.g. abandon search, dismiss temporary path)

improvements:

- path list has subpaths

- starts, ends and branches have circles;
    - start points and end points are squares
    - branch points are circles

- change the message about confirming temporary paths so that if we
  selected a join, then it says, "save and complete"

so, PathAndFillManager now contains Path objects

  - a Path object is an ArrayList of points

  - there is an index stored that indicates the last confirmed part
    (or -1 if it's unconfirmed)

  - Path objects can occur independently of the Path manager
    (e.g. before adding, they're just kept in the Tracer plugin)

  - holding down control can mark an end point as well



a join (either a branch at the start or the end) is defined by a Path
reference and an index into that path's point list


PathAndFillManager can draw paths onto a Graphics

draw( Graphics g );

addPath( Path newPath );
addPath( Path newPath, Path branchesOff );

deletePath( int index );




holding down control locks the crosshair to the nearest point on that path




variable "slices each side" to show
  apply "slices each side" to all panes?




------------------------------------------------------------------------

For fitting centres:

  - assume that we're trying to place a circle
  - intensity is the maximum in that slice
  - three parameters to optimize: position from centre in x, y in the normal plane and 

------------------------------------------------------------------------

For fitting centres:

  - assume that we're trying to place a circle
  - intensity is the maximum in that slice
  - three parameters to optimize: position from centre in x, y in the normal plane and 

------------------------------------------------------------------------

-- New interface:

One of a number of states:

WAITING_TO_START_PATH

  1. Status: "Click somewhere to start a new path"
       (button: Cancel Search (disabled))
       (button: Complete Path (disabled))
       (button: Cancel Path (disabled))

 ... after clicking go to PARTIAL_PATH

PARTIAL_PATH (special case first point)

  2. Status: "Now select a point further along that structure"
              (button: Cancel Search (disabled))
              (button: Complete Path (disabled if first point))
              (button: Cancel Path)

... on selecting go to: SEARCHING

... on "cancel path", remove the complete path and go to WAITING_TO_START_PATH
... on "complete path", add the complete path to the list and go to WAITING_TO_START_PATH

SEARCHING

  3. Status: "Searching for goal..."
             (button: Cancel Search)
             (button: Complete Path (disabled))
             (button: Cancel Path (disabled))
     
... on cancel, move to state: PARTIAL_PATH
... on successful completion, move to state QUERY_KEEP

QUERY_KEEP

  4. Status: "Keep that path segment?"
           (buttons: Yes, No)
           (button: Complete Path (disabled))
           (button: Cancel Path (disabled))

on Yes, add the segment and go to PARTIAL_PATH
on No, don't add the segment and go to PARTIAL_PATH

TRACING

  5. Stratus: Filling out from neuron...

           Mousing over a pixel will show the threshold there.
           Clicking will set the threshold to that value.
           

           Also should have a box with 
           
           






Dialog Design:
--------------

Status: <message here>

Panel for contextual buttons:
   Yes, No, Cancel Search

Complete Path | Cancel Path

------------------------------------------

View paths: |  "Projected through all slices"
            |  "Parts in nearby slices"

Preprocess  (checkbox - disabled in SEARCHING)

Just Log Points (checkbox - disables everything else)

------------------------------------------

Path List:  (selecting one of these highlights it in the image)

 1: exterior - pb - fb - exterior
 2: 
 3: 
 4: 

 -----------------
 |  Delete Path  |  (Fill Out)  (Move Through)
 -----------------

------------------------------------------

------------------------------------
|    Save Traces  |   Load Traces  |
------------------------------------
|   Upload Traces |  Fetch Traces  |
------------------------------------
